<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/assets/css/just-the-docs-default.css"><link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"><style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li:not(:nth-child(1)) > a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(4) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(3) > ul > li:nth-child(4) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list > li.nav-list-item:nth-child(4) > ul.nav-list { display: block; }</style><script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico" type="image/x-icon"><title>ZoomPhant Log Query Language | ZoomPhant Documentation</title><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="ZoomPhant Log Query Language" /><meta property="og:locale" content="en_US" /><meta name="description" content="How to use ZoomPhant Platform to solve all your monitoring problems" /><meta property="og:description" content="How to use ZoomPhant Platform to solve all your monitoring problems" /><link rel="canonical" href="https://zoomphant.github.io/docs/manual/03_log/syntax/" /><meta property="og:url" content="https://zoomphant.github.io/docs/manual/03_log/syntax/" /><meta property="og:site_name" content="ZoomPhant Documentation" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ZoomPhant Log Query Language" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"How to use ZoomPhant Platform to solve all your monitoring problems","headline":"ZoomPhant Log Query Language","url":"https://zoomphant.github.io/docs/manual/03_log/syntax/"}</script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-S50K8F1PWF"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-S50K8F1PWF'); </script><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-copy" viewBox="0 0 16 16"><title>Copy</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"><title>Copied</title><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"><path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg><div class="side-bar"><div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> ZoomPhant Documentation </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in About category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/" class="nav-list-link">About</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/about/" class="nav-list-link">Why ZoomPhant</a><li class="nav-list-item"><a href="/docs/about/work/" class="nav-list-link">How ZoomPhant Works</a><li class="nav-list-item"><a href="/docs/about/qa/" class="nav-list-link">Q & A</a></ul><li class="nav-list-item"><a href="/docs/start/" class="nav-list-link">Quick Start</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in References category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/" class="nav-list-link">References</a><ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Alerting & Notifications category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/00_alert/" class="nav-list-link">Alerting & Notifications</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/00_alert/delivery/" class="nav-list-link">Alert Delivery</a><li class="nav-list-item"><a href="/docs/manual/00_alert/alert/" class="nav-list-link">Alert Settings</a></ul><li class="nav-list-item"><a href="/docs/manual/01_service/" class="nav-list-link">Monitoring Service</a><li class="nav-list-item"><a href="/docs/manual/02_collector/" class="nav-list-link">Data Collectors</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Log Monitoring category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/03_log/" class="nav-list-link">Log Monitoring</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/03_log/syntax/" class="nav-list-link">ZoomPhant Log Query Language</a><li class="nav-list-item"><a href="/docs/manual/03_log/add/" class="nav-list-link">Add Log Monitoring</a><li class="nav-list-item"><a href="/docs/manual/03_log/usecase/" class="nav-list-link">Log Monitoring Use-cases</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Template Plugins category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/04_templates/" class="nav-list-link">Template Plugins</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/04_templates/grafana/" class="nav-list-link">Import Grafana Dashboard</a><li class="nav-list-item"><a href="/docs/manual/04_templates/prom/" class="nav-list-link">Prometheus Template Plugin</a><li class="nav-list-item"><a href="/docs/manual/04_templates/snmp/" class="nav-list-link">SNMP Template Plugin</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Infrastructure Monitoring category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/10_infrastructures/" class="nav-list-link">Infrastructure Monitoring</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/10_infrastructures/linux/" class="nav-list-link">Linux Monitoring</a><li class="nav-list-item"><a href="/docs/manual/10_infrastructures/windows/" class="nav-list-link">Windows Monitoring</a><li class="nav-list-item"><a href="/docs/manual/10_infrastructures/kubernetes/" class="nav-list-link">Kubernetes Monitoring</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Network Monitoring category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/20_network/" class="nav-list-link">Network Monitoring</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/20_network/dns/" class="nav-list-link">DNS Monitoring</a><li class="nav-list-item"><a href="/docs/manual/20_network/port/" class="nav-list-link">Port Monitoring</a><li class="nav-list-item"><a href="/docs/manual/20_network/route/" class="nav-list-link">Route Monitoring</a><li class="nav-list-item"><a href="/docs/manual/20_network/ping/" class="nav-list-link">Ping Monitoring</a><li class="nav-list-item"><a href="/docs/manual/20_network/http/" class="nav-list-link">HTTP Monitoring</a></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Applications Monitoring category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/99_plugins/" class="nav-list-link">Applications Monitoring</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/99_plugins/proxmox/" class="nav-list-link">ProxmoxVE Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/kafka/" class="nav-list-link">Kafka Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/redis/" class="nav-list-link">Redis Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/nginx/" class="nav-list-link">Nginx Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/sqlqueryexporter/" class="nav-list-link">Sql query exporter</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/glusterfs/" class="nav-list-link">GlusterFS</a><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Windows WMI Monitoring category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/manual/99_plugins/windows/" class="nav-list-link">Windows WMI Monitoring</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/manual/99_plugins/windows/account/" class="nav-list-link">Create Windows Monitoring Account</a></ul><li class="nav-list-item"><a href="/docs/manual/99_plugins/linux/" class="nav-list-link">Linux SNMP Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/docker/" class="nav-list-link">Docker Container Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/ethereum/" class="nav-list-link">Ethereum Blockchain Monitoring</a><li class="nav-list-item"><a href="/docs/manual/99_plugins/nvidiagpu/" class="nav-list-link">Nvidia GPU Monitoring</a></ul></ul><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Concepts category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/docs/concepts/" class="nav-list-link">Concepts</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/concepts/metrics/" class="nav-list-link">Metrics</a><li class="nav-list-item"><a href="/docs/concepts/logs/" class="nav-list-link">Logs</a><li class="nav-list-item"><a href="/docs/concepts/dashboards/" class="nav-list-link">Dashboards</a></ul></ul></nav><footer class="site-footer"> Copyright © 2024 <a href="https://zoomphant.github.io/">Zervice</a></footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search" role="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search ZoomPhant Documentation" aria-label="Search ZoomPhant Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/ZoomPhant/zoomphant.github.io" class="site-button" > ZoomPhant Docs on GitHub </a></ul></nav></div><div class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/docs/manual/">References</a><li class="breadcrumb-nav-list-item"><a href="/docs/manual/03_log/">Log Monitoring</a><li class="breadcrumb-nav-list-item"><span>ZoomPhant Log Query Language</span></ol></nav><div id="main-content" class="main-content"><main><p>ZoomPhant using a streaming processing lanuage to process the logs, and a log processing statement may contain following parts:</p><ol><li>Log Filtering: Using labels or keywords to reduce the size of logs to be processed<li>Log Processing: Processing the filtered logs to do conversion / analyzing or grouping, etc.<li>Log Presenting: Decides how to present the processed logs, e.g. show as pure logs or a diagram in given shapes, etc.</ol><p>For a quick reference, you can refer to <a href="./Log_Query_CheatSheet.jpg">Log_Query_CheatSheet</a></p><h2 id="syntax"> <a href="#syntax" class="anchor-heading" aria-labelledby="syntax"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Syntax</h2><p>ZoomPhant Log Query Language is a staged stream processing language, the statement is separated by pipe ‘|’ into different processing stage and having an overall syntax as follows</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ streamFiltering } keywordsFiltering | processorFunc1 [args...] | processorFunc2 [args...] /as displayType
</code></pre></div></div><p>In above stage, the first stage is a filtering stage (more details below), this stage is optional by strongly recommended, followed by one or more processing stage, and could be ended with an optinal display specification.</p><p>Before explaining the details of the processing functions, let’s see how strings could be expressed in the syntax.</p><p>Strings are widely used as label value, keyword and processor arguments, etc. We support different ways to express a string, which can bring convenience for users in different situations.</p><h3 id="double-quoted-strings"> <a href="#double-quoted-strings" class="anchor-heading" aria-labelledby="double-quoted-strings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Double Quoted Strings</h3><p>This is the most common way to express strings: quote the string in double quotes, and in the string there shall have no double quote.</p><p>Below are examples of valid double quoted strings.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"error"
"Error"
"He's great"
"/api/ping"
</code></pre></div></div><p>And it is illegal to have a double quote in the double quoted string:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"invalid "double quote""
</code></pre></div></div><h3 id="single-quoted-strings"> <a href="#single-quoted-strings" class="anchor-heading" aria-labelledby="single-quoted-strings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Single Quoted Strings</h3><p>We can use single quoted string to express strings with double quotes, but in single quoted strings there shall be no single quote.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‘Error’
‘The "test" string is OK'
'/api/ping'
</code></pre></div></div><p>Single quote is not allowed in single quoted strings:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'invalid 'single quote''
</code></pre></div></div><h3 id="tick-quoted-strings"> <a href="#tick-quoted-strings" class="anchor-heading" aria-labelledby="tick-quoted-strings"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Tick Quoted Strings</h3><p>In case you need to use both single and double quotes in your string, you can use the tick quoted strings, as shown below:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`Error`
`The "double quoted" string and 'single quoted' string`
`/api/ping`
</code></pre></div></div><p>But tick shall not show up in tick quoted strings:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`Illegal `back quote``
</code></pre></div></div><h3 id="re2-expression"> <a href="#re2-expression" class="anchor-heading" aria-labelledby="re2-expression"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> RE2 Expression</h3><p>RE2 expression is a special string, we use slash ‘/’ to enclose such strings, as shown below</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/.*mysql.*/
/192\.168\.3\.\d{1,3}/
</code></pre></div></div><p>For more information about RE2 syntax, you can refer to <a href="https://github.com/google/re2/wiki/Syntax">https://github.com/google/re2/wiki/Syntax</a>.</p><h2 id="log-filtering"> <a href="#log-filtering" class="anchor-heading" aria-labelledby="log-filtering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Filtering</h2><p>Log volumes could be huge, so when querying and processing logs, we shall filter those logs that we want to process first to improve the efficency.</p><p>There are two types of filtering:</p><ol><li>Log Stream Filtering: A log stream is identified by the label set, so this kind of filtering will try to filter the label values to select the correct stream to process.<li>Keyword Fitlering: Keyword filtering can be used to further filter log lines with certain keywords.</ol><p>As said above, each log query statement shall try to use filters to reduce the volume of queried logs to improve the performance.</p><h3 id="log-stream-filtering"> <a href="#log-stream-filtering" class="anchor-heading" aria-labelledby="log-stream-filtering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Stream Filtering</h3><p>As said above, log stream filtering filters against the log labels. The basic syntax for filtering a label is as follows:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  labelName &lt;Operator&gt; labelValue
</code></pre></div></div><p>Depends on the operator, the labelValue could be</p><ul><li>Double, single or tick quoted strings<li>RE2 regular expressions enclosed by slashes</ul><p>Here the operator could be:</p><ol><li>= The label value matches the given string exactly<li>!= The label value doesn’t exactly match the given string<li>~ The label value matches the given RE2 expression<li>!~ The label value doesn’t match the given RE2 expression</ol><p>Two or more label filters could be <strong><em>and</em></strong>-ed or <strong><em>or</em></strong>-ed together to create a complex log stream filter against multiple labels:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  _instanceName ~ "prod.*" and _category="database"
</code></pre></div></div><h3 id="keyword-filtering"> <a href="#keyword-filtering" class="anchor-heading" aria-labelledby="keyword-filtering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Keyword Filtering</h3><p>Keywords filtering will be used on log lines directly. Used with log stream filtering, it can further reduce the volume of the logs to be queried and processed.</p><p>Keywords can be any strings in double, single or tick quotes, it can also be a RE2 expression in certain situations. Following are valid keywords:</p><ol><li>Single quoted string keyword: ‘keyword’<li>Double quoted string keyword: “keyword”<li>Keyword in RE2 expression: /key?word/</ol><p>Like label filters, we can use <strong>and</strong>, <strong>or</strong> and <strong>not</strong> keywords to create complex keyword filtering against multiple keyworkds, for example:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  "Error" or "Exception"
</code></pre></div></div><p>or</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  /.*mysql.*/ and not "database"
</code></pre></div></div><h3 id="using-filtering"> <a href="#using-filtering" class="anchor-heading" aria-labelledby="using-filtering"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using Filtering</h3><p>When using filtering, we support two ways to specify label and keyword filters</p><ol><li>Using Literals: this can only be used on start of query statement<li>Using Functions: We can add one or more processing stages using filtering functions</ol><h4 id="using-literals"> <a href="#using-literals" class="anchor-heading" aria-labelledby="using-literals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using Literals</h4><p>Filtering literals can only be used at start of a query statement, we would recommend user to always starts with filtering literals to improve log querying and processing.</p><p>The syntax for filtering literals is as follows:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ &lt;stream filtering&gt; } &lt;keyword filtering&gt;
</code></pre></div></div><p>In this syntax, the filtering contains two optional parts</p><ol><li>the stream filters, surounded by brackets<li>followed by optional keyword filters</ol><p>Following are some examples using above syntax</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{_source~/.*prod-\d+/ and _cagetory="webserver"} "Error" or "Warn"
{level="error" or level="warn"}
"/api/ping" and "error"
</code></pre></div></div><h4 id="using-functions"> <a href="#using-functions" class="anchor-heading" aria-labelledby="using-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using Functions</h4><p>Filering literals can only be used at start of query statement. To make your query statement easier to understand, you can use filtering functions, which can appear at different stages. Filtering functions has following syntax</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>funcName filterExpression
</code></pre></div></div><p>We will have more details for supported filtering functions later, for now we can see below examples for using filtering functions</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>grep "Error" | grep -v "website"
match "Error" or "Warn" | filter _category="database"
filter _source!~/.*mysql.*/ and _level="error" | grep -v "test"
</code></pre></div></div><h2 id="log-processing--displaying"> <a href="#log-processing--displaying" class="anchor-heading" aria-labelledby="log-processing--displaying"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Processing &amp; Displaying</h2><p>After we have filtered out the logs we want to process, we may need to further processing the logs like extracting certain information from log lines, counting the lines and find patterns about appearances of certain keywords, etc.</p><p>We use functions to do such processing, and the processed result could be presented in different formats using the displaying options.</p><h2 id="log-functions"> <a href="#log-functions" class="anchor-heading" aria-labelledby="log-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Functions</h2><p>We call the each processing method a function, and according to the type of processing, we can group the functions as:</p><ol><li>Log Filtering Functions: Used to filter logs using labels or keywords to achieve the same purpose as using <strong>filtering literals</strong> mentioned above.<li>Log Expanding Functions: Used to generate dynamic labels, converting log lines, extracting information from log labels or log lines, etc.<li>Log Processing Functions: Used to create timeseries from log streams and do analyzing / aggregations on the timeseries.</ol><h3 id="log-filtering-functions"> <a href="#log-filtering-functions" class="anchor-heading" aria-labelledby="log-filtering-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Filtering Functions</h3><p>We support following special functions to filter against log labels (streams) and log lines (keywords)</p><ul><li><strong>grep</strong>: Used to filter log lines against one keyword, an optional -v option could be used to inverse the effect, as shown in below examples<ul><li><strong>grep</strong> “12345”<ul><li>Finding all the loglines that contains 12345</ul><li><strong>grep</strong> <strong>-v</strong> 12345<ul><li>Finding all the logs that <strong>not</strong> contains 12345</ul></ul><li><strong>match</strong>: Used to filter log lines against multiple keywords by using keyword filtering expressions. User can use brackets to change the default processing order, for example:<ul><li><strong>match</strong> <strong>(</strong>“Failed” <strong>or</strong> “failed”<strong>)</strong> <strong>and</strong> /192.168.\d{1,3}.\d{1,3}/<ul><li>Find all log lines containing one of “Failed” and “failed”, and also with a matching IP address</ul><li><strong>match</strong> “error” <strong>and</strong> “network”<ul><li>Find all lines containing both “error” and “network”</ul></ul><li><strong>filter</strong>: Used to filter log streams or log labels. Like above <strong>match</strong> function, it expects user to provide a label filtering expression as arguments, for example<ul><li><strong>filter</strong> service <strong>=</strong> “finance”<ul><li>Filter all log streams with a service label with value “finance”</ul><li><strong>filter</strong> location <strong>!=</strong> “Canada”<ul><li>Filter all log streams with a location label not equal to “Canada”</ul><li><strong>filter</strong> name <strong>~</strong> /Instance .*/ <strong>and</strong> _category <strong>=</strong> “website”<ul><li>Filter log streams with name label matching given RE2 exrepssion and _category label set to “website”</ul></ul></ul><h3 id="log-expanding-functions"> <a href="#log-expanding-functions" class="anchor-heading" aria-labelledby="log-expanding-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Expanding Functions</h3><p>Those functions can help convert log stream by expanding labels or cnverting the log lines. For now we support following functions</p><ul><li><strong>json</strong>: Take the log line as valid JSON and extract the fields in this JSON as labels. Existing labels may be overwritten by this operation. For example<ul><li>json<ul><li>with out argument, each field will be generated as a label</ul><li>json location, size<ul><li>Extract the location and size field to create new location and size labels</ul></ul><li><strong>pattern</strong>: This is the same as the Loki pattern processing function, which can be used to quickly extract pattern form log lines and generate new labels. It would expect a pattern as argument and use it to match the log lines, using blank space as separator. You can give a name using &lt;<em>labelNamne</em>&gt; to generate a label with the matching part or special &lt;_&gt; to ignore that part. For example,<ul><li>pattern ‘&lt;ip&gt; - - <_> "\&lt;method\&gt; \&lt;uri\&gt; <_>" \&lt;status\&gt; \&lt;size\&gt; <_>' </_></_></_><ul><li>Match a log line, with the first part used to generate ip, method, uri, status and size labels</ul></ul><li><strong>regexp</strong>: Using RE2 syntax to matching named pattern and using the name to generate labels<ul><li>regexp /POST (?P<uri>.*) .* (?P<code>\d+) (?P<size>\d+)/ </size></code></uri><ul><li>Matching the url, code and size part to generate labels accordingly</ul></ul><li><strong>logfmt</strong>: Take the log lines as following the logfmt format and convert the key=value pairs as labels. You can visit following link for more information<ul><li>https://www.brandur.org/logfmt</ul></ul><p>More log expanding functions will be supported in the future.</p><h3 id="log-processing-functions"> <a href="#log-processing-functions" class="anchor-heading" aria-labelledby="log-processing-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Processing Functions</h3><p>Log lines are hard to extract useful information and to display. We can use log processing functions to vectorize the loglines as time series to identify patterns and presenting to customers.</p><p>To processing the log lines for above purpose, we need to through following steps</p><ol><li>Vectorize logs: This is the first step and we would generate the initial timeseries from the log lines which can be further processed and displayed<li>Timeseries processing: We can using various aggregation and processing functions to process the generated timeseries.<li>Data presenting: With the final data, we can shall it in a way easier for user to understand the data</ol><h4 id="log-vectorizing-function"> <a href="#log-vectorizing-function" class="anchor-heading" aria-labelledby="log-vectorizing-function"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Vectorizing Function</h4><p>ZoomPhant support a <strong>range</strong> function to vectorize the log lines or log labels in given steps:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  range &lt;vecorizingRange or step&gt; use convertingFunc [&lt;convertingParam1&gt; ...]
  range &lt;labelName&gt; &lt;vecorizingRange or step&gt; use convertingFunc [&lt;convertingParam1&gt; ...] [without|by (labelSet)]
</code></pre></div></div><p>In above syntax</p><ul><li>the first is used to vectorize against log lines<li>the second is used to vectorize against given <strong>labelName</strong><ul><li>When aggregate against labels, a <strong>labelSet</strong> can be provided to filter or aggregation log streams</ul></ul><p>In both cases,</p><ul><li><strong>vecorizingRange</strong> or step is used to given the a time range to vectorize the log, it is given in format like 5m, 1h or <strong><em>auto</em></strong> so ZoomPhant can automatically decide the value.<li><strong>convertingFunc</strong> is a name to decide what kind of function we can use to do the vectorizization, as shown below</ul><h5 id="converting-function-for-log-lines"> <a href="#converting-function-for-log-lines" class="anchor-heading" aria-labelledby="converting-function-for-log-lines"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Converting Function for Log Lines</h5><p>If we try to vectorize against the log lines, we can using following converting functions</p><ul><li><strong>rate</strong>: Number of log lines generated per second every given time range (speed)<li><strong>count</strong>: Number of log lines generated in given time range<li><strong>bytes_rate</strong>: Number of bytes per second generated every given time range (speed)<li><strong>bytes_count</strong>: Number of bytes generated in given time range<li><strong>absent</strong>: if any logs generated every given time range. If yes a vector with value 1 is returned, otherwise an empty vector is returned</ul><h5 id="converting-function-for-log-labels"> <a href="#converting-function-for-log-labels" class="anchor-heading" aria-labelledby="converting-function-for-log-labels"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Converting Function for Log Labels</h5><p>To vectorize against a given label following function could be used</p><ul><li><strong>rate</strong>：Taken the label value as a number, the change rate of the accumulated sum in given time range<li><strong>sum</strong>：Taken the label value as a number, the accumulated sum in given time range<li><strong>avg</strong>：Taken the label value as a number, the average value in given time range<li><strong>max</strong>：Taken the label value as a number, the maximum value in given time range<li><strong>min</strong>：Taken the label value as a number, the minimum value in given time range<li><strong>first</strong>：Taken the label value as a number, the first non-null value in given time range<li><strong>last</strong>：Taken the label value as a number, the last non-null value in given time range<li><strong>stdvar</strong>：Taken the label value as a number, the standard variation value in given time range<li><strong>stddev</strong>：Taken the label value as a number, the standard deviation value in given time range<li><strong>quantile</strong>：Taken the label value as a number, the proportion of values above given percentile. The percentile is given as a number like 90 as the first argument and if missing taken as 90 percentile<li><strong>absent</strong>：If no value in gime time range, return an empty vector, otherwise an vector with value 1 is returned</ul><h4 id="log-processing-functions-1"> <a href="#log-processing-functions-1" class="anchor-heading" aria-labelledby="log-processing-functions-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Processing Functions</h4><p>Once we have vectorized timeseries data, we can further processing the timeseries using log processing functions in following syntax</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;funcName&gt; [&lt;funcParam1&gt; ...] (without|by) (labelSet)
</code></pre></div></div><p>So the log processing functions can further filter / aggregation the timeseries using given label set, and following functions are supported</p><ul><li><strong>sum</strong>: Calculate theaccumulated value aggregated by given label set<li><strong>avg</strong>: Calculate average value aggregated by given label set<li><strong>min</strong>: Get the minimum value aggregated by given label set<li><strong>max</strong>: Get maximum value aggregated by given label set<li><strong>stdvar</strong>: Calculate the standard variation aggregated by given label set<li><strong>stddev</strong>: Calculate the standard deviation aggregated by given label set<li><strong>count</strong>: Count the number of streams aggregated by the given label set<li><strong>top</strong>: Return the top N series aggregated by the given labelset, N is given as the first param, default to 3 if not given<li><strong>bottom</strong>: Return the bottom N series aggregated by the given labelset, N is given as the first param, default to 3 if not given</ul><h4 id="log-display-options"> <a href="#log-display-options" class="anchor-heading" aria-labelledby="log-display-options"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Log Display Options</h4><p>By default we display log data as just log lines and timeseries data as colored lines. User can use the display option to override the display if it applies</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  /as &lt;displayOption&gt;
</code></pre></div></div><p>Here, <strong>displayOption</strong> could be one of following</p><ul><li><strong>line</strong> or <strong>lines</strong>: Display the timeseries data as lines, this is the default<li><strong>pie</strong> or <strong>pies</strong>: Display the timeseries as pie diagrams<li><strong>bar</strong> or <strong>bars</strong>: Display the timeseries as bar diagrams<li><strong>area</strong> or <strong>areas</strong>: Display the timeseries as areas.<li><strong>stack</strong> or <strong>stacks</strong>: Display the timeseries as stacked areas.</ul></main><hr><footer><p><a href="#top" id="back-to-top">Back to Top</a></p><p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 <a href="https://zoomphant.github.io/">Zervice</a></p><div class="d-flex mt-2"></div></footer></div></div><div class="search-overlay"></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> <script type="text/javascript" src="https://app.promptai.us/ava/chatbot.app?config=ZW5naW5lPXJhc2EmaWQ9YTFfcF9kaWFud3hvYzc0c2cmdG9rZW49TjJVNFpEQTBNMlV0WVRoalpTMDBNV0l4TFdFMU9UZ3RaV1ppWXpJeU1URTBNekUxJnByb2plY3Q9cF9kaWFud3hvYzc0c2cmc2NlbmU9cHVibGlzaF9zbmFwc2hvdCZuYW1lPVByb21wdCUyMEFJ"></script>
